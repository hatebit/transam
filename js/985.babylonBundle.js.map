{"version":3,"file":"js/985.babylonBundle.js","mappings":"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","sources":["webpack://trans-america/./assets/concrete.png","webpack://trans-america/./src/scenes/boxes.ts","webpack://trans-america/./src/scenes/car.ts","webpack://trans-america/./src/scenes/controls.ts","webpack://trans-america/./src/externals/ammo.ts","webpack://trans-america/./src/scenes/proRacer.ts","webpack://trans-america/./assets/sand.jpg","webpack://trans-america/./src/scenes/world.ts"],"sourcesContent":["export default __webpack_public_path__ + \"03713868bab7dd2e96995060bf2ae0f5.png\";","import { Material } from \"@babylonjs/core/Materials/material\";\nimport { StandardMaterial } from \"@babylonjs/core/Materials/standardMaterial\";\nimport { Color3, Vector3 } from \"@babylonjs/core/Maths/math\";\nimport { Mesh } from \"@babylonjs/core/Meshes/mesh\";\nimport { MeshBuilder } from \"@babylonjs/core/Meshes/meshBuilder\";\nimport { PhysicsImpostor } from \"@babylonjs/core/Physics/physicsImpostor\";\nimport { Scene } from \"@babylonjs/core/scene\";\nimport {Texture} from \"@babylonjs/core/Materials/Textures/texture\";\n\nimport concreteTextureUrl from \"../../assets/concrete.png\";\n\nexport class Boxes {\n    blueMaterial: StandardMaterial;\n    concreteMaterial: StandardMaterial;\n    scene: Scene;\n\n    constructor(scene: Scene) {\n        this.scene = scene;\n\n        this.blueMaterial = new StandardMaterial(\"BlueMaterial\", scene);\n        this.blueMaterial.diffuseColor = new Color3(0.5,0.4,0.8);\n        this.blueMaterial.emissiveColor = new Color3(0.5,0.4,0.8);\n        \n        this.concreteMaterial = new StandardMaterial(\"concrete material\", scene);\n        this.concreteMaterial.diffuseTexture = new Texture(concreteTextureUrl, scene);\n    }\n\n    public baseBoxes() : void {\n        this.createBox(new Vector3(4,1,12),new Vector3(0,0,25),new Vector3(-Math.PI/8,0,0),0);\n        this.createBox(new Vector3(4,1,12),new Vector3(25,0,0),new Vector3(-Math.PI/8,Math.PI/2,0),0);\n        this.createBox(new Vector3(4,1,12),new Vector3(0,0,-25),new Vector3(Math.PI/8,0,0),0);\n        this.createBox(new Vector3(4,1,12),new Vector3(-25,0,0),new Vector3(Math.PI/8,Math.PI/2,0),0);\n    }\n\n    public randomBoxes() : void {\n        const s = new Vector3();\n        const p = new Vector3();\n        const r = new Vector3();\n        for(let i=0;i<20;i++){\n            const m = Math.random()*300-150+5;\n            const m3 = Math.random()*300-150+5;\n            const m2 = Math.random()*10;\n            s.set(m2,m2,m2);\n            p.set(m3,0,m);\n            r.set(m,m,m);\n            this.createBox(s,p,r,0);\n        }\n    \n        for(let i=0;i<30;i++){\n            const m = Math.random()*300-150+5;\n            const m3 = Math.random()*300-150+5;\n            const m2 = Math.random()*3;\n            s.set(m2,m2,m2);\n            p.set(m3,0,m);\n            r.set(m,m,m);\n            this.createBox(s,p,r,5);\n        }\n    }\n\n    private createBox(size: Vector3, position: Vector3, rotation: Vector3, mass: number) : Mesh {\n        const box = MeshBuilder.CreateBox(\"box\", { width: size.x, depth: size.z, height: size.y }, this.scene);\n        box.position.set(position.x,position.y,position.z);\n        box.rotation.set(rotation.x,rotation.y,rotation.z);\n        if(!mass){\n            mass = 0;\n            box.material = this.concreteMaterial\n        } else {\n            box.position.y += 5;\n            box.material = this.blueMaterial;\n    \n        }\n        box.physicsImpostor = new PhysicsImpostor(box, PhysicsImpostor.BoxImpostor, { mass: mass, friction: 0.5, restitution: 0.7 }, this.scene);\n        return box;\n    }\n    \n    public cellBoxes(cellSize: number, cell: Mesh) : void {\n        const halfCellSize = cellSize/2;\n        const s = new Vector3();\n        const p = new Vector3();\n        const r = new Vector3();\n        for(let i=0;i<20;i++){\n            const m = Math.random()*cellSize-halfCellSize;\n            const m3 = Math.random()*cellSize-halfCellSize;\n            const m2 = Math.random()*10;\n            s.set(m2,m2,m2);\n            p.set(m3,0,m);\n            r.set(m,m,m);\n            const box = this.createBox(s,p,r,0);\n            box.parent = cell;\n        }\n    }\n\n    private createCellBox(size: Vector3, position: Vector3, rotation: Vector3, mass: number) : Mesh {\n        const box = MeshBuilder.CreateBox(\"box\", { width: size.x, depth: size.z, height: size.y });\n        box.position.set(position.x,position.y,position.z);\n        box.rotation.set(rotation.x,rotation.y,rotation.z);\n        if(!mass){\n            mass = 0;\n            box.material = this.concreteMaterial\n        } else {\n            box.position.y += 5;\n            box.material = this.blueMaterial;\n\n        }\n        box.physicsImpostor = new PhysicsImpostor(box, PhysicsImpostor.BoxImpostor, { mass: mass, friction: 0.5, restitution: 0.7 }, this.scene);\n        return box;\n    }\n\n}\n\n","import {Mesh, StandardMaterial} from \"@babylonjs/core\";\nimport {Color3, Quaternion, Vector3} from \"@babylonjs/core/Maths/math\";\nimport {MeshBuilder} from \"@babylonjs/core/Meshes/meshBuilder\";\nimport {Scene} from \"@babylonjs/core/scene\";\n\nexport class Car {\n    ZERO_QUATERNION = new Quaternion();\n\n    FRONT_LEFT = 0;\n    FRONT_RIGHT = 1;\n    BACK_LEFT = 2;\n    BACK_RIGHT = 3;\n\n    chassisWidth = 1.8;\n    chassisHeight = .6;\n    chassisLength = 4;\n    massVehicle = 200;\n\n\n    wheelAxisPositionBack = -1;\n    wheelRadiusBack = .4;\n    wheelWidthBack = .3;\n    wheelHalfTrackBack = 1;\n    wheelAxisHeightBack = 0.4;\n\n    wheelAxisFrontPosition = 1.0;\n    wheelHalfTrackFront = 1;\n    wheelAxisHeightFront = 0.4;\n    wheelRadiusFront = .4;\n    wheelWidthFront = .3;\n\n    friction = 5;\n    suspension = {\n        stiffness: 10,\n        damping: 0.3,\n        compression: 4.4,\n        restLength: 0.6\n    }\n\n    rollInfluence = 0.0;\n\n    wheelDirectionCS0: number | undefined;\n    wheelAxleCS: number | undefined;\n\n    steeringIncrement = .01;\n    steeringClamp = 0.2;\n    maxEngineForce = 500;\n    maxBreakingForce = 10;\n    incEngine = 10.0;\n\n    vehicleSteering = 0;\n    engineForce = 0;\n    breakingForce = 0;\n\n    private scene: Scene;\n\n    greenMaterial: StandardMaterial;\n    blackMaterial: StandardMaterial;\n\n\n    tuning: any;\n    vehicle: any;\n    wheelMeshes: Mesh[] = [];\n    chassisMesh: Mesh;\n\n\n    vehicleReady = false;\n    \n    ammoModule: any;\n    body: any;\n\n    constructor(pos: Vector3, scene: Scene, ammoModule: any) {\n        this.greenMaterial = new StandardMaterial(\"GreenMaterial\", scene);\n        this.greenMaterial.diffuseColor = new Color3(0.1, 0.8, 0.5);\n        this.greenMaterial.emissiveColor = new Color3(0.1, 0.8, 0.5);\n\n        this.blackMaterial = new StandardMaterial(\"BlackMaterial\", scene);\n        this.blackMaterial.diffuseColor = new Color3(0.1, 0.1, 0.1);\n        this.blackMaterial.emissiveColor = new Color3(0.1, 0.1, 0.1);\n\n        this.scene = scene;\n        //Going Native\n        const physicsWorld = scene.getPhysicsEngine()?.getPhysicsPlugin().world;\n\n        this.wheelDirectionCS0 = new ammoModule.btVector3(0, -1, 0);\n        this.wheelAxleCS = new ammoModule.btVector3(-1, 0, 0);\n\n        const geometry = new ammoModule.btBoxShape(new ammoModule.btVector3(\n            this.chassisWidth * .5,\n            this.chassisHeight * .5,\n            this.chassisLength * .5));\n        const transform = new ammoModule.btTransform();\n        transform.setIdentity();\n        transform.setOrigin(new ammoModule.btVector3(0, 5, 0));\n        transform.setRotation(new ammoModule.btQuaternion(\n            this.ZERO_QUATERNION.x,\n            this.ZERO_QUATERNION.y,\n            this.ZERO_QUATERNION.z,\n            this.ZERO_QUATERNION.w));\n        const motionState = new ammoModule.btDefaultMotionState(transform);\n        const localInertia = new ammoModule.btVector3(0, 0, 0);\n        geometry.calculateLocalInertia(this.massVehicle, localInertia);\n\n\n        this.chassisMesh = this.createChassisMesh(this.chassisWidth, this.chassisHeight, this.chassisLength);\n\n\n        const massOffset = new ammoModule.btVector3(0, 0.4, 0);\n        const transform2 = new ammoModule.btTransform();\n        transform2.setIdentity();\n        transform2.setOrigin(massOffset);\n        const compound = new ammoModule.btCompoundShape();\n        compound.addChildShape(transform2, geometry);\n\n        const body = new ammoModule.btRigidBody(new ammoModule.btRigidBodyConstructionInfo(this.massVehicle, motionState, compound, localInertia));\n        body.setActivationState(4);\n\n        physicsWorld.addRigidBody(body);\n\n\n        this.tuning = new ammoModule.btVehicleTuning();\n        const rayCaster = new ammoModule.btDefaultVehicleRaycaster(physicsWorld);\n        this.vehicle = new ammoModule.btRaycastVehicle(this.tuning, body, rayCaster);\n        this.vehicle.setCoordinateSystem(0, 1, 2);\n        physicsWorld.addAction(this.vehicle);\n\n        const trans = this.vehicle.getChassisWorldTransform();\n\n        this.addWheel(true,\n            new ammoModule.btVector3(this.wheelHalfTrackFront, this.wheelAxisHeightFront, this.wheelAxisFrontPosition),\n            this.wheelRadiusFront, this.wheelWidthFront, this.FRONT_LEFT);\n        this.addWheel(true,\n            new ammoModule.btVector3(-this.wheelHalfTrackFront, this.wheelAxisHeightFront, this.wheelAxisFrontPosition),\n            this.wheelRadiusFront, this.wheelWidthFront, this.FRONT_RIGHT);\n        this.addWheel(false,\n            new ammoModule.btVector3(-this.wheelHalfTrackBack, this.wheelAxisHeightBack, this.wheelAxisPositionBack),\n            this.wheelRadiusBack, this.wheelWidthBack, this.BACK_LEFT);\n        this.addWheel(false,\n            new ammoModule.btVector3(this.wheelHalfTrackBack, this.wheelAxisHeightBack, this.wheelAxisPositionBack),\n            this.wheelRadiusBack, this.wheelWidthBack, this.BACK_RIGHT);\n\n        this.vehicleReady = true;\n        \n        this.ammoModule = ammoModule;\n        this.body = body;\n    }\n    \n    public reset() {\n        const origin = new this.ammoModule.btVector3(0, 5, 0);\n        const transform = new this.ammoModule.btTransform();\n        transform.setOrigin(origin);\n        transform.setRotation(new this.ammoModule.btQuaternion(\n            this.ZERO_QUATERNION.x,\n            this.ZERO_QUATERNION.y,\n            this.ZERO_QUATERNION.z,\n            this.ZERO_QUATERNION.w));\n\n        this.body.setWorldTransform(transform);\n    }\n\n    private createChassisMesh(w: number, l: number, h: number): Mesh {\n        const mesh = MeshBuilder.CreateBox(\"box\", {width: w, depth: h, height: l}, this.scene);\n        mesh.rotationQuaternion = new Quaternion();\n        mesh.material = this.greenMaterial;\n        return mesh;\n    }\n\n    private addWheel(isFront: boolean, pos: Vector3, radius: number, width: number, index: number) {\n\n        const wheelInfo = this.vehicle.addWheel(\n            pos,\n            this.wheelDirectionCS0,\n            this.wheelAxleCS,\n            this.suspension.restLength,\n            radius,\n            this.tuning,\n            isFront);\n\n        wheelInfo.set_m_suspensionStiffness(this.suspension.stiffness);\n        wheelInfo.set_m_wheelsDampingRelaxation(this.suspension.damping);\n        wheelInfo.set_m_wheelsDampingCompression(this.suspension.compression);\n        wheelInfo.set_m_maxSuspensionForce(600000);\n        wheelInfo.set_m_frictionSlip(40);\n        wheelInfo.set_m_rollInfluence(this.rollInfluence);\n\n        this.wheelMeshes[index] = this.createWheelMesh(radius, width);\n    }\n\n    private createWheelMesh(radius: number, width: number) {\n        //var mesh = new BABYLON.MeshBuilder.CreateBox(\"wheel\", {width:.82, height:.82, depth:.82}, scene);\n        const mesh = MeshBuilder.CreateCylinder(\"Wheel\", {\n            diameter: 1, height: 0.5, tessellation: 6\n        }, this.scene);\n        mesh.rotationQuaternion = new Quaternion();\n        mesh.material = this.blackMaterial;\n        return mesh;\n    }\n}","import { Axis } from \"@babylonjs/core/Maths/math\";\nimport { Car } from \"./car\";\n\nconst actions = new Map<string, boolean>([\n    [\"acceleration\", false],\n    [\"braking\", false],\n    [\"right\", false],\n    [\"left\", false],\n    [\"reset\", false],\n    [\"stop\", false]\n]);\n\nconst keysActions = new Map<string, string>([\n    [\"KeyW\",'acceleration'],\n    [\"KeyS\",'braking'],\n    [\"KeyA\",'left'],\n    [\"KeyD\",'right'],\n    [\"KeyR\",'reset'],\n    [\"Space\", \"stop\"]\n]);\n\nexport class Controls {\n\n    car: Car;\n\n    constructor(car: Car) {\n        this.car = car;\n        window.addEventListener( 'keydown', this.keydown);\n        window.addEventListener( 'keyup', this.keyup);\n    }\n\n    update() {\n        if(this.car.vehicleReady){\n                  \n            const speed = this.car.vehicle.getCurrentSpeedKmHour();\n            const maxSteerVal = 0.2;\n            this.car.breakingForce = 0;\n            this.car.engineForce = 0;\n\n            if (actions.get(\"reset\")) {\n                //this.car.chassisMesh.position.set(0, 5, 0);\n                this.car.reset();\n                console.log(\"reset \" + this.car.chassisMesh.position);\n            }\n            \n            if (actions.get(\"acceleration\")){\n                if (speed < -1){\n                    this.car.breakingForce = this.car.maxBreakingForce;\n                }else {\n                    this.car.engineForce = this.car.maxEngineForce;\n                }\n                    \n            } else if (actions.get(\"braking\")){\n                if (speed > 1){\n                    this.car.breakingForce = this.car.maxBreakingForce;\n                }else {\n                    this.car.engineForce = -this.car.maxEngineForce ;\n                }\n            } else if(actions.get(\"stop\")) {\n                if (speed > 1){\n                    this.car.breakingForce = this.car.maxBreakingForce*2;\n                } else if (speed < -1){\n                    this.car.engineForce = this.car.maxEngineForce*2;\n                }\n            }\n                    \n            if(actions.get(\"right\")){\n                if (this.car.vehicleSteering < this.car.steeringClamp){\n                    this.car.vehicleSteering += this.car.steeringIncrement;\n                }\n                    \n            } else if(actions.get(\"left\")){\n                if (this.car.vehicleSteering > -this.car.steeringClamp){\n                    this.car.vehicleSteering -= this.car.steeringIncrement;\n                }\n                    \n            } else {\n                this.car.vehicleSteering = 0;\n            }\n                    \n            this.car.vehicle.applyEngineForce(this.car.engineForce, this.car.FRONT_LEFT);\n            this.car.vehicle.applyEngineForce(this.car.engineForce, this.car.FRONT_RIGHT);\n                    \n            this.car.vehicle.setBrake(this.car.breakingForce / 2, this.car.FRONT_LEFT);\n            this.car.vehicle.setBrake(this.car.breakingForce / 2, this.car.FRONT_RIGHT);\n            this.car.vehicle.setBrake(this.car.breakingForce, this.car.BACK_LEFT);\n            this.car.vehicle.setBrake(this.car.breakingForce, this.car.BACK_RIGHT);\n                    \n            this.car.vehicle.setSteeringValue(this.car.vehicleSteering, this.car.FRONT_LEFT);\n            this.car.vehicle.setSteeringValue(this.car.vehicleSteering, this.car.FRONT_RIGHT);\n                    \n                    \n            let matrix, origin, rotation, i;\n            const n = this.car.vehicle.getNumWheels();\n            for (i = 0; i < n; i++) {\n                this.car.vehicle.updateWheelTransform(i, true);\n                matrix = this.car.vehicle.getWheelTransformWS(i);\n                origin = matrix.getOrigin();\n                rotation = matrix.getRotation();\n                this.car.wheelMeshes[i].position.set(origin.x(), origin.y(), origin.z());\n                this.car.wheelMeshes[i].rotationQuaternion?.set(rotation.x(), rotation.y(), rotation.z(), rotation.w());\n                this.car.wheelMeshes[i].rotate(Axis.Z, Math.PI/2);\n            }\n\n            matrix = this.car.vehicle.getChassisWorldTransform();\n            origin = matrix.getOrigin();\n            rotation = matrix.getRotation();\n            this.car.chassisMesh.position.set(origin.x(), origin.y(), origin.z());\n            this.car.chassisMesh.rotationQuaternion?.set(rotation.x(), rotation.y(), rotation.z(), rotation.w());\n            this.car.chassisMesh.rotate(Axis.X, Math.PI);\n                 \n        }\n    }\n\n    private keyup(e: KeyboardEvent) {\n        if(keysActions.get(e.code)) {\n            actions.set(keysActions.get(e.code)??\"\", false);\n            //e.preventDefault();\n            //e.stopPropagation();\n\n            //return false;\n        }\n    }\n\n    private keydown(e: KeyboardEvent) {\n        if(keysActions.get(e.code)) {\n            actions.set(keysActions.get(e.code)??\"\", true);\n            //e.preventDefault();\n            //e.stopPropagation();\n\n            //return false;\n        }\n    }\n\n\n}\n","import * as Ammo from \"ammo.js\";\n\nexport let ammoModule: any;\nexport const ammoReadyPromise = new Promise((resolve) => {\n    new Ammo().then((res: unknown) => {\n        ammoModule = res;\n        resolve(res);\n    });\n});\n","import {Engine} from \"@babylonjs/core/Engines/engine\";\nimport {Scene} from \"@babylonjs/core/scene\";\nimport {FreeCamera} from \"@babylonjs/core/Cameras/freeCamera\";\nimport {Vector3} from \"@babylonjs/core/Maths/math.vector\";\nimport {HemisphericLight} from \"@babylonjs/core/Lights/hemisphericLight\";\nimport {AmmoJSPlugin} from \"@babylonjs/core/Physics/Plugins/ammoJSPlugin\";\nimport \"@babylonjs/core/Physics/physicsEngineComponent\";\n\n// If you don't need the standard material you will still need to import it since the scene requires it.\nimport \"@babylonjs/core/Materials/standardMaterial\";\nimport {PhysicsImpostor} from \"@babylonjs/core/Physics/physicsImpostor\";\nimport {ammoModule, ammoReadyPromise} from \"../externals/ammo\";\nimport {CreateSceneClass} from \"../createScene\";\nimport {MeshBuilder} from \"@babylonjs/core/Meshes/meshBuilder\";\nimport {StandardMaterial} from \"@babylonjs/core/Materials/standardMaterial\";\nimport * as GRID from \"@babylonjs/materials/grid\";\n\nimport {Boxes} from \"./boxes\"\nimport {Car} from \"./car\";\nimport {Controls} from \"./controls\";\nimport {DEFAULT_CELL_SIZE, WorldMap} from \"./world\";\nimport {FollowCamera} from \"@babylonjs/core/Cameras/followCamera\";\nimport {fpsDiv, speedDiv, positionDiv} from \"../dom\";\n\nclass ProRacerScene implements CreateSceneClass {\n    preTasks = [ammoReadyPromise];\n\n    createScene = async (engine: Engine, canvas: HTMLCanvasElement): Promise<Scene> => {\n        // This creates a basic Babylon Scene object (non-mesh)\n        const scene = new Scene(engine);\n        \n        // This creates a light, aiming 0,1,0 - to the sky (non-mesh)\n        const light = new HemisphericLight(\"light\", new Vector3(0, 1, 0), scene);\n        // Default intensity is 1. Let's dim the light a small amount\n        light.intensity = 0.7;\n\n\n        scene.enablePhysics(new Vector3(0, -10, 0), new AmmoJSPlugin(true, ammoModule));\n        \n\n        const car = new Car(new Vector3(0, 4, -20), scene, ammoModule);\n        const camera = new FollowCamera(\"FollowCam\", new Vector3(0, 10, -10), scene);\n        camera.radius = 10;\n        camera.heightOffset = 4;\n        camera.rotationOffset = 0;\n        camera.cameraAcceleration = 0.05;\n        camera.maxCameraSpeed = 400;\n        camera.attachControl(true);//camera.attachControl(canvas, true);\n        camera.lockedTarget = car.chassisMesh; //version 2.5 onwards\n        scene.activeCamera = camera;\n        \n        // Ground + Obstacles\n        const world = new WorldMap(scene)\n\n        const boxes = new Boxes(scene)\n        // boxes.baseBoxes();\n        //boxes.randomBoxes();\n\n\n        \n        const controls = new Controls(car);\n\n        let lastX = -9999, lastZ = -9999\n\n        scene.registerBeforeRender(function () {\n            const dt = engine.getDeltaTime()/*.toFixed()*/ / 1000;\n            controls.update();\n            const carPos = car.chassisMesh.position;\n            const currX = Math.round(carPos.x / DEFAULT_CELL_SIZE)|0\n            const currZ = Math.round(carPos.z / DEFAULT_CELL_SIZE)|0\n            if (lastX !== currX || lastZ !== currZ) {\n                console.log(currX, currZ)\n                lastX = currX\n                lastZ = currZ\n            }\n            world.update(currX, currZ)\n            fpsDiv.innerHTML = engine.getFps().toFixed() + \" fps\";\n            positionDiv.innerHTML = currX+\",\"+currZ;\n            speedDiv.innerHTML = car.vehicle.getCurrentSpeedKmHour().toFixed() + \" km/h\"\n\n        });\n\n        return scene;\n    };\n\n}\n\nexport default new ProRacerScene();\n","export default __webpack_public_path__ + \"c8f55e9ef9e4d3c0a223a3adaad7ad23.jpg\";","import {Scene} from \"@babylonjs/core/scene\";\nimport {MeshBuilder} from \"@babylonjs/core/Meshes/meshBuilder\";\nimport {PhysicsImpostor} from \"@babylonjs/core/Physics/physicsImpostor\";\nimport * as GRID from \"@babylonjs/materials/grid\";\nimport {GridMaterial} from \"@babylonjs/materials/grid\";\nimport {GroundMesh} from \"@babylonjs/core\";\n\nimport sandTextureUrl from \"../../assets/sand.jpg\";\nimport { Texture } from \"@babylonjs/core/Materials/Textures/texture\";\nimport {StandardMaterial} from \"@babylonjs/core/Materials/standardMaterial\";\nimport {Boxes} from \"./boxes\";\nimport {Color3, Color4} from \"@babylonjs/core/Maths/math\";\n\nexport const DEFAULT_CELL_SIZE = 100;\n\nexport class WorldMap {\n    //private material: GridMaterial;\n    private material: StandardMaterial;\n    \n    private debugMaterial: StandardMaterial;\n\n    private cells = new Map();\n    private scene: Scene;\n\n    constructor(scene: Scene) {\n        this.scene = scene;\n\n        //this.material = new GRID.GridMaterial(\"groundMaterial\", scene);\n        this.material = new StandardMaterial(\"ground material\", scene);\n        const texture = new Texture(sandTextureUrl, scene);\n        this.material.diffuseTexture = texture;\n        texture.uScale = 10;\n        texture.vScale = 10;\n\n        scene.fogMode = Scene.FOGMODE_LINEAR;\n        scene.fogStart = 20.0;\n        scene.fogEnd = 120.0;\n        scene.fogColor = new Color3(0.9, 0.9, 0.85);\n        scene.fogDensity = 0.03;\n        scene.clearColor = new Color4(0.9, 0.9, 0.85, 1.0);\n\n\n\n        this.debugMaterial = new StandardMaterial(\"BlueMaterial\", scene);\n        this.debugMaterial.diffuseColor = new Color3(0.5,0.4,0.8);\n        this.debugMaterial.emissiveColor = new Color3(0.5,0.4,0.8);\n\n\n    }\n\n    public update(x: number, z: number): void {\n        const indexes = [\n            [x + 1, z + 1],\n            [x + 1, z],\n            [x + 1, z - 1],\n            [x, z + 1],\n            [x, z],\n            [x, z - 1],\n            [x - 1, z + 1],\n            [x - 1, z],\n            [x - 1, z - 1],\n        ];\n        // const indexes = [ [x, z]];\n        for (const index of indexes) {\n            const xx = index[0]\n            const zz = index[1]\n            if (!this.cells.has(`${xx},${zz}`)) {\n                const cell  = this.createCell(this.scene, xx, zz);\n                this.cells.set(`${xx},${zz}`, cell);\n                console.log(`Created cell ${xx},${zz}`);\n                return; // only create one cell per update\n            }\n        }\n        //console.log(this.cells.size);\n        for (const key of this.cells.keys()) {\n            const [xs, zs] = key.split(\",\");\n            const xx = parseInt(xs);\n            const zz = parseInt(zs);\n            if (xx < (x - 1) || xx > (x + 1) || zz < (z - 1) || zz > (z + 1)) {\n            // if (xx != x || zz != z) {\n                const cell = this.cells.get(key);\n                if (cell) {\n                    this.scene.removeMesh(cell);\n                    cell.dispose();\n                    this.cells.delete(key);\n                }\n            }\n        }\n\n    }\n\n    private createCell(scene: Scene, x: number, z: number): GroundMesh {\n        const ground = MeshBuilder.CreateGround(\"ground\", {\n            width: DEFAULT_CELL_SIZE,\n            height: DEFAULT_CELL_SIZE,\n            subdivisions: 2\n        }, scene);\n\n        ground.position.set(x * DEFAULT_CELL_SIZE, 0, z * DEFAULT_CELL_SIZE);\n\n        ground.physicsImpostor = new PhysicsImpostor(ground, PhysicsImpostor.BoxImpostor, {\n            mass: 0,\n            friction: 0.5,\n            restitution: 0.7\n        }, scene);\n        \n        const halfCellSize = DEFAULT_CELL_SIZE/2;\n\n        // START: Dev boxes\n        const box = MeshBuilder.CreateBox(\"box\", { width: 1, depth: 1, height: 4 }, this.scene);\n        box.material = this.debugMaterial;\n        ground.addChild(box);\n        const box0 = MeshBuilder.CreateBox(\"box\", { width: 1, depth: 1, height: 8 }, this.scene);\n        box0.material = this.debugMaterial;\n        box0.position.set(x * DEFAULT_CELL_SIZE + halfCellSize, 4, z * DEFAULT_CELL_SIZE + halfCellSize);\n        ground.addChild(box0);\n        const box1 = MeshBuilder.CreateBox(\"box\", { width: 1, depth: 1, height: 8 }, this.scene);\n        box1.material = this.debugMaterial;\n        box1.position.set(x * DEFAULT_CELL_SIZE - halfCellSize, 4, z * DEFAULT_CELL_SIZE - halfCellSize);\n        ground.addChild(box1);\n        // END: Dev boxes\n        \n        new Boxes(this.scene).cellBoxes(DEFAULT_CELL_SIZE, ground);\n\n        ground.material = this.material;\n\n        return ground;\n    }\n\n}\n"],"names":["Boxes","constructor","scene","this","blueMaterial","diffuseColor","emissiveColor","concreteMaterial","diffuseTexture","concrete","baseBoxes","createBox","Math","PI","randomBoxes","s","p","r","i","m","random","m3","m2","set","size","position","rotation","mass","box","CreateBox","width","x","depth","z","height","y","material","physicsImpostor","BoxImpostor","friction","restitution","cellBoxes","cellSize","cell","halfCellSize","parent","createCellBox","Car","pos","ammoModule","ZERO_QUATERNION","FRONT_LEFT","FRONT_RIGHT","BACK_LEFT","BACK_RIGHT","chassisWidth","chassisHeight","chassisLength","massVehicle","wheelAxisPositionBack","wheelRadiusBack","wheelWidthBack","wheelHalfTrackBack","wheelAxisHeightBack","wheelAxisFrontPosition","wheelHalfTrackFront","wheelAxisHeightFront","wheelRadiusFront","wheelWidthFront","suspension","stiffness","damping","compression","restLength","rollInfluence","steeringIncrement","steeringClamp","maxEngineForce","maxBreakingForce","incEngine","vehicleSteering","engineForce","breakingForce","wheelMeshes","vehicleReady","greenMaterial","blackMaterial","physicsWorld","getPhysicsEngine","getPhysicsPlugin","world","wheelDirectionCS0","btVector3","wheelAxleCS","geometry","btBoxShape","transform","btTransform","setIdentity","setOrigin","setRotation","btQuaternion","w","motionState","btDefaultMotionState","localInertia","calculateLocalInertia","chassisMesh","createChassisMesh","massOffset","transform2","compound","btCompoundShape","addChildShape","body","btRigidBody","btRigidBodyConstructionInfo","setActivationState","addRigidBody","tuning","btVehicleTuning","rayCaster","btDefaultVehicleRaycaster","vehicle","btRaycastVehicle","setCoordinateSystem","addAction","getChassisWorldTransform","addWheel","reset","origin","setWorldTransform","l","h","mesh","rotationQuaternion","isFront","radius","index","wheelInfo","set_m_suspensionStiffness","set_m_wheelsDampingRelaxation","set_m_wheelsDampingCompression","set_m_maxSuspensionForce","set_m_frictionSlip","set_m_rollInfluence","createWheelMesh","CreateCylinder","diameter","tessellation","actions","Map","keysActions","Controls","car","window","addEventListener","keydown","keyup","update","speed","getCurrentSpeedKmHour","matrix","get","console","log","applyEngineForce","setBrake","setSteeringValue","n","getNumWheels","updateWheelTransform","getWheelTransformWS","getOrigin","getRotation","rotate","Z","X","e","code","ammoReadyPromise","Promise","resolve","then","res","preTasks","createScene","async","engine","canvas","intensity","enablePhysics","camera","heightOffset","rotationOffset","cameraAcceleration","maxCameraSpeed","attachControl","lockedTarget","activeCamera","WorldMap","controls","lastX","lastZ","registerBeforeRender","getDeltaTime","carPos","currX","round","DEFAULT_CELL_SIZE","currZ","innerHTML","getFps","toFixed","cells","texture","sand","uScale","vScale","fogMode","FOGMODE_LINEAR","fogStart","fogEnd","fogColor","fogDensity","clearColor","debugMaterial","indexes","xx","zz","has","createCell","key","keys","xs","zs","split","parseInt","removeMesh","dispose","delete","ground","CreateGround","subdivisions","addChild","box0","box1"],"sourceRoot":""}