"use strict";(self.webpackChunktrans_america=self.webpackChunktrans_america||[]).push([[443],{3443:(e,t,i)=>{i.r(t),i.d(t,{Car:()=>a});var s=i(3325),h=i(9529),n=i(2404);class a{constructor(e,t){this.ZERO_QUATERNION=new h.PT,this.FRONT_LEFT=0,this.FRONT_RIGHT=1,this.BACK_LEFT=2,this.BACK_RIGHT=3,this.chassisWidth=1.8,this.chassisHeight=.6,this.chassisLength=4,this.massVehicle=200,this.wheelAxisPositionBack=-1,this.wheelRadiusBack=.4,this.wheelWidthBack=.3,this.wheelHalfTrackBack=1,this.wheelAxisHeightBack=.4,this.wheelAxisFrontPosition=1,this.wheelHalfTrackFront=1,this.wheelAxisHeightFront=.4,this.wheelRadiusFront=.4,this.wheelWidthFront=.3,this.friction=5,this.suspension={stiffness:10,damping:.3,compression:4.4,restLength:.6},this.rollInfluence=0,this.steeringIncrement=.01,this.steeringClamp=.2,this.maxEngineForce=500,this.maxBreakingForce=10,this.incEngine=10,this.vehicleSteering=0,this.engineForce=0,this.breakingForce=0,this.wheelMeshes=[],this.vehicleReady=!1,this.greenMaterial=new s.FUi("GreenMaterial",e),this.greenMaterial.diffuseColor=new h.v9(.1,.8,.5),this.greenMaterial.emissiveColor=new h.v9(.1,.8,.5),this.blackMaterial=new s.FUi("BlackMaterial",e),this.blackMaterial.diffuseColor=new h.v9(.1,.1,.1),this.blackMaterial.emissiveColor=new h.v9(.1,.1,.1),this.scene=e;const i=e.getPhysicsEngine()?.getPhysicsPlugin().world;this.wheelDirectionCS0=new t.btVector3(0,-1,0),this.wheelAxleCS=new t.btVector3(-1,0,0);const n=new t.btBoxShape(new t.btVector3(.5*this.chassisWidth,.5*this.chassisHeight,.5*this.chassisLength)),a=new t.btTransform;a.setIdentity(),a.setOrigin(new t.btVector3(0,5,0)),a.setRotation(new t.btQuaternion(this.ZERO_QUATERNION.x,this.ZERO_QUATERNION.y,this.ZERO_QUATERNION.z,this.ZERO_QUATERNION.w));const o=new t.btDefaultMotionState(a),l=new t.btVector3(0,0,0);n.calculateLocalInertia(this.massVehicle,l),this.chassisMesh=this.createChassisMesh(this.chassisWidth,this.chassisHeight,this.chassisLength);const r=new t.btVector3(0,.4,0),c=new t.btTransform;c.setIdentity(),c.setOrigin(r);const w=new t.btCompoundShape;w.addChildShape(c,n);const d=new t.btRigidBody(new t.btRigidBodyConstructionInfo(this.massVehicle,o,w,l));d.setActivationState(4),i.addRigidBody(d),this.tuning=new t.btVehicleTuning;const g=new t.btDefaultVehicleRaycaster(i);this.vehicle=new t.btRaycastVehicle(this.tuning,d,g),this.vehicle.setCoordinateSystem(0,1,2),i.addAction(this.vehicle),this.vehicle.getChassisWorldTransform(),this.addWheelToVehicle(!0,new t.btVector3(this.wheelHalfTrackFront,this.wheelAxisHeightFront,this.wheelAxisFrontPosition),this.wheelRadiusFront,this.wheelWidthFront,this.FRONT_LEFT),this.addWheelToVehicle(!0,new t.btVector3(-this.wheelHalfTrackFront,this.wheelAxisHeightFront,this.wheelAxisFrontPosition),this.wheelRadiusFront,this.wheelWidthFront,this.FRONT_RIGHT),this.addWheelToVehicle(!1,new t.btVector3(-this.wheelHalfTrackBack,this.wheelAxisHeightBack,this.wheelAxisPositionBack),this.wheelRadiusBack,this.wheelWidthBack,this.BACK_LEFT),this.addWheelToVehicle(!1,new t.btVector3(this.wheelHalfTrackBack,this.wheelAxisHeightBack,this.wheelAxisPositionBack),this.wheelRadiusBack,this.wheelWidthBack,this.BACK_RIGHT),this.vehicleReady=!0,this.ammoModule=t,this.body=d}setPosition(e){const t=new this.ammoModule.btVector3(e.x,e.y,e.z),i=new this.ammoModule.btTransform;i.setOrigin(t),i.setRotation(new this.ammoModule.btQuaternion(this.ZERO_QUATERNION.x,this.ZERO_QUATERNION.y,this.ZERO_QUATERNION.z,this.ZERO_QUATERNION.w)),this.body.setWorldTransform(i)}createChassisMesh(e,t,i){const s=n.P.CreateBox("box",{width:e,depth:i,height:t},this.scene);return s.rotationQuaternion=new h.PT,s.material=this.greenMaterial,s}addWheelToVehicle(e,t,i,s,h){const n=this.vehicle.addWheel(t,this.wheelDirectionCS0,this.wheelAxleCS,this.suspension.restLength,i,this.tuning,e);n.set_m_suspensionStiffness(this.suspension.stiffness),n.set_m_wheelsDampingRelaxation(this.suspension.damping),n.set_m_wheelsDampingCompression(this.suspension.compression),n.set_m_maxSuspensionForce(6e5),n.set_m_frictionSlip(40),n.set_m_rollInfluence(this.rollInfluence),this.wheelMeshes[h]=this.createWheelMesh(i,s)}createWheelMesh(e,t){const i=n.P.CreateCylinder("Wheel",{diameter:1,height:.5,tessellation:6},this.scene);return i.rotationQuaternion=new h.PT,i.material=this.blackMaterial,i}}}}]);