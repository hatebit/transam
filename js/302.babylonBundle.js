"use strict";(self.webpackChunktrans_america=self.webpackChunktrans_america||[]).push([[302],{7075:(o,n,i)=>{i.r(n),i.d(n,{Cell:()=>l,CellFactory:()=>c});var O=i(517),j=i(2404),f=i(5714),e=i(1508),t=i(3077);const s=i.p+"c8f55e9ef9e4d3c0a223a3adaad7ad23.jpg",a=i.p+"c77efafbfaba1476dc4fbf577bd891b4.jpg",K=i.p+"6d13a2bb82c1085c7c8712db8fdbb67d.png";var q,r=i(9529);!function(o){o.GRASS=":",o.WALL="#",o.OCEAN="~",o.SAND=".",o.SNOW="*",o.WATER="o"}(q||(q={}));class l{constructor(o,n){this.name=o,this.mesh=n}}class c{constructor(o){this.scene=o,this.sandMaterial=new O.F("sand material",o);const n=new t.g(s,o);n.vScale=10,n.uScale=10,this.sandMaterial.diffuseTexture=n,this.grassMaterial=new O.F("grass material",o);const i=new t.g(a,o);i.uScale=10,i.vScale=10,this.grassMaterial.diffuseTexture=i,this.oceanMaterial=new O.F("ocean material",o);const j=new t.g(K,o);j.uScale=10,j.vScale=10,this.oceanMaterial.diffuseTexture=j,this.debugMaterial=new O.F("BlueMaterial",o),this.debugMaterial.diffuseColor=new r.v9(.5,.4,.8),this.debugMaterial.emissiveColor=new r.v9(.5,.4,.8),this.snowMaterial=new O.F("snow material",o),this.snowMaterial.diffuseColor=new r.v9(1,1,1),this.snowMaterial.emissiveColor=new r.v9(1,1,1)}createCell(o,n,i,O){switch(O.kind){case q.SAND:return new u(o,n,i,O.name,this.sandMaterial);case q.GRASS:return new u(o,n,i,O.name,this.grassMaterial);case q.WALL:return new h(o,n,i,O.name,this.sandMaterial);case q.OCEAN:return new u(o,n,i,O.name,this.oceanMaterial);case q.SNOW:return new u(o,n,i,O.name,this.snowMaterial);default:return new h(o,n,i,O.name,this.debugMaterial)}}}class u extends l{constructor(o,n,i,O,t){super(O,j.P.CreateGround("ground",{width:e.DEFAULT_CELL_SIZE,height:e.DEFAULT_CELL_SIZE,subdivisions:2},o)),this.mesh.position.set(n*e.DEFAULT_CELL_SIZE,0,i*e.DEFAULT_CELL_SIZE),this.mesh.physicsImpostor=new f.j(this.mesh,f.j.BoxImpostor,{mass:0,friction:.5,restitution:.7},o),this.mesh.material=t}}class h extends l{constructor(o,n,i,O,t){super(O,j.P.CreateBox("cube",{size:e.DEFAULT_CELL_SIZE},o)),this.mesh.position.set(n*e.DEFAULT_CELL_SIZE,0,i*e.DEFAULT_CELL_SIZE),this.mesh.physicsImpostor=new f.j(this.mesh,f.j.BoxImpostor,{mass:0,friction:.5,restitution:.7},o),this.mesh.material=t}}},1508:(o,n,i)=>{i.r(n),i.d(n,{DEFAULT_CELL_SIZE:()=>s,WorldMap:()=>a});var O=i(2971),j=i(3325),f=i(9529),e=i(8070),t=i(7075);const s=100;class a{constructor(o){this.cells=new Map,this.lastX=-9999,this.lastZ=-9999,this.noUpdateNeeded=!1,this.mapArr=[],this.scene=o,this.cellFactory=new t.CellFactory(o);let n=this,i=new j.rw3(o),e=i.addTextFileTask("task","data:text/plain;charset=utf-8;base64,KioqKioqKioqKioqKioqKioqKipvKm8qKioqKioqKioqKioqKioqKioqKioqfn5+fioqKioqKioqKioqKioqKgoqKioqKioqKioqKioqKioqKioqKioqKioqKipvb28qKioqKioqKioqKioqKip+fn5+KioqKioqKioqKioqKioqCioqKioqKioqKioqKioqKioqKioqKioqKioqKm9vb28qKioqKioqKioqKioqKip+fn4qKioqKioqKioqKioqKioKKioqKioqKioqKioqKioqKioqKioqKioqKioqbypvbyoqKioqKioqKioqKioqKip+fioqKioqKioqKioqKioqKgoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKm9vbyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCn4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKm8qKioqKioqKioqKioqKioqKioqKn5+fn4Kfn5+Kio6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OjoqKioqb29vKioqKioqKioqKioqKioqKn5+fn4qfgp+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6b29vb29vKioqKioqKioqKioqKip+fioqKip+Cn5+fjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Om9vb29vb28qKioqKioqKioqKioqKn46OioqKioKfn5+Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojpvb29vb28qKioqKioqKioqOjo6KioqKgp+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6b286Om9vb28qKioqOjo6Ojo6Ojo6fioqCn5+fjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6OjpvOjo6b28qKipvbzo6Ojo6Ojo6fn5+KioKfn5+Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Om9vOjo6Km9vOjo6Ojo6Ojo6fn5+fn5+fgp+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6bzo6Ojpvbzo6Ojo6Ojo6Ojo6fn5+fn5+Cn5+fjo6Ojo6Ojo6Ojo6Om86Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6fn5+fn5+fn4Kfn5+fjo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6fn5+fn5+fn5+fgp+fn5+Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6On5+fn5+fn5+fn5+Cn5+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6fn5+fn5+fn5+fn4Kfn5+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6On5+fn5+fn5+fn5+fgp+fn5+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6fn5+fn5+fn5+fn5+Cn5+fn5+fn46Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6On5+fn5+fn5+fn5+fn4Kfn5+fn5+fn5+Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojp+fn5+fn5+fn5+fn5+fgp+fn5+fn5+fn5+Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6fn5+fn5+fn5+fn5+fn5+Cn5+fn5+fn5+fn5+IyM6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6On5+fn5+fn5+fn5+fn5+fn4Kfn5+fn5+fn5+fn5+I35+IyMjIyMjIzo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojo6Ojp+fn5+fn5+fn5+fn5+fn5+fgp+fn5+fn5+fn5+fn4uLn4uLi4uLi4jIzo6Ojo6Ojo6Ojo6Ojo6On5+fn46Ojo6On5+fn5+fn5+fn5+fn5+fn5+Cn5+fn5+fn5+fn5+fn4ufn4uLi4uLi4jIyMjIzo6Ojo6On5+fn5+fn5+fn5+fjo6On5+fn5+fn5+fn5+fn5+fn4Kfn5+fn5+fn5+fn5+fi4ufn4uLi4uLi4uLi4jIzo6On5+fn5+fn5+fn5+fn5+Ojo6fn5+fn5+fn5+fn5+fn5+fgp+fn5+fn5+fn5+fn5+Li4ufn4uLi4uLi4uLi4jOjo6fn5+fn5+fn5+fn5+fn46bzp+fn5+fn5+fn5+fn5+fn5+Cn5+fn5+fn5+fn5+fn5+fi4ufi4uLi4uLi4uLiMjIyN+fn5+fn5+fn5+fn5+fjo6On5+fn5+fn5+fn5+fn5+fn4Kfn5+fn5+fn5+fn5+fn5+Li5+fn4uLi4uLi4uLi4ufn5+fn5+fn5+fn5+fn5+fjp+fn5+fn5+fn5+fn5+fn5+fgp+fn5+fn5+fn5+fn5+fn5+Li5+fn4uLi4uLi4uLi5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+Cn5+fn5+fn5+fn5+fn5+fn5+Li5+fn4uLi4uLi4uLn5+fn5+fn5+fn5+fn46Ojo6On5+fn5+fn5+fn5+fn5+fn4Kfn5+fn5+fn5+fn5+fn5+fn5+fn5+fi4uLi4uLi4ufn5+fn5+fn5+fn5+fjp+fn46Ojo6fn5+fn5+fn5+fn5+fgp+fn5+fn5+fn5+fn5+fn5+fn5+fn5+Li4uLi4uLi4ufn5+fn5+Ojo6On5+fn5+fn5+Ojo6On5+fn5+fn5+fn5+");i.onTaskError=function(o){alert("error while loading "+o.name)},e.onError=function(o,n,i){alert(n),alert(i)},e.onSuccess=function(o){n.mapArr=o.text.split("\n")},i.onFinish=function(o){console.log("done loading")},i.load(),o.fogMode=O.Z.FOGMODE_LINEAR,o.fogStart=20,o.fogEnd=120,o.fogColor=new f.v9(.9,.9,.85),o.fogDensity=.03,o.clearColor=new f.ov(.9,.9,.85,1)}update(o,n){return!(this.lastX!==o||this.lastZ!==n||!this.noUpdateNeeded)||(this.lastX=o,this.lastZ=n,console.log(o,n),e.Xz.innerHTML=o+","+n,e.Iq.style.left=5*o+"px",e.Iq.style.top=5*n+"px",e.wm.innerHTML=this.cells.get(`${o}_${n}`)?.name||"Failure",0===this.mapArr.length?(console.log("NOT READY!"),!0):(this.noUpdateNeeded=this.updateInternal(o,n),this.noUpdateNeeded))}updateInternal(o,n){const i=[[o+1,n+1],[o+1,n],[o+1,n-1],[o,n+1],[o,n],[o,n-1],[o-1,n+1],[o-1,n],[o-1,n-1]];for(const o of i){const n=o[0],i=o[1];let O=`${n}_${i}`;if(!this.cells.has(O)){this.cells.set(O,null);let o="bad";n>=0&&i>=0&&n<this.mapArr[0].length&&i<this.mapArr.length&&(o=this.mapArr[i][n]);let j={name:"Valid "+o,kind:o};const f=this.cellFactory.createCell(this.scene,n,i,j);return this.cells.set(O,f),!1}}for(const i of this.cells.keys()){const[O,j]=i.split(","),f=parseInt(O),e=parseInt(j);if(f<o-1||f>o+1||e<n-1||e>n+1){const o=this.cells.get(i);o&&(this.scene.removeMesh(o.mesh),o.mesh.dispose(),this.cells.delete(i))}}return!0}}}}]);